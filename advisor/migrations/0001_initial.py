# Generated by Django 5.2 on 2025-07-15 04:38

import django.core.validators
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='SubsidyType',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, verbose_name='補助金名')),
                ('description', models.TextField(verbose_name='説明')),
                ('max_amount', models.IntegerField(verbose_name='最大金額（万円）')),
                ('target_business_type', models.CharField(max_length=255, verbose_name='対象事業種別')),
                ('requirements', models.TextField(verbose_name='申請要件')),
                ('typical_application_months', models.JSONField(default=list, help_text='例: [1, 4, 7, 10]', verbose_name='通常の申請月')),
                ('average_preparation_weeks', models.IntegerField(default=8, verbose_name='平均準備期間（週）')),
                ('historical_success_rate', models.FloatField(default=0.25, verbose_name='過去の成功率')),
                ('application_difficulty', models.IntegerField(choices=[(1, 'レベル1'), (2, 'レベル2'), (3, 'レベル3'), (4, 'レベル4'), (5, 'レベル5')], default=3, verbose_name='申請難易度（1-5）')),
                ('is_active', models.BooleanField(default=True, verbose_name='アクティブ')),
                ('last_updated', models.DateTimeField(auto_now=True, verbose_name='最終更新')),
            ],
            options={
                'verbose_name': '補助金種別',
                'verbose_name_plural': '補助金種別',
            },
        ),
        migrations.CreateModel(
            name='TrendAnalysis',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('analysis_date', models.DateField(verbose_name='分析日')),
                ('seasonal_patterns', models.JSONField(default=dict, verbose_name='季節パターン')),
                ('budget_trends', models.JSONField(default=dict, verbose_name='予算トレンド')),
                ('competition_analysis', models.JSONField(default=dict, verbose_name='競合分析')),
                ('success_rate_trends', models.JSONField(default=dict, verbose_name='成功率トレンド')),
                ('emerging_opportunities', models.JSONField(default=list, verbose_name='新たな機会')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='作成日時')),
            ],
            options={
                'verbose_name': 'トレンド分析',
                'verbose_name_plural': 'トレンド分析',
                'ordering': ['-analysis_date'],
            },
        ),
        migrations.CreateModel(
            name='ConversationHistory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('session_id', models.CharField(max_length=255, verbose_name='セッションID')),
                ('message_type', models.CharField(choices=[('user', 'ユーザー'), ('assistant', 'アシスタント'), ('system', 'システム')], max_length=20, verbose_name='メッセージ種別')),
                ('content', models.TextField(verbose_name='メッセージ内容')),
                ('metadata', models.JSONField(default=dict, help_text='信頼度、推奨補助金、使用モデル等', verbose_name='メタデータ')),
                ('intent_analysis', models.JSONField(default=dict, verbose_name='意図分析結果')),
                ('user_context', models.JSONField(default=dict, verbose_name='ユーザーコンテキスト')),
                ('timestamp', models.DateTimeField(auto_now_add=True, verbose_name='タイムスタンプ')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='ユーザー')),
            ],
            options={
                'verbose_name': '会話履歴',
                'verbose_name_plural': '会話履歴',
                'ordering': ['-timestamp'],
            },
        ),
        migrations.CreateModel(
            name='Question',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('session_id', models.CharField(max_length=100, verbose_name='セッションID')),
                ('question_text', models.TextField(verbose_name='質問内容')),
                ('business_type', models.CharField(blank=True, max_length=100, verbose_name='事業種別')),
                ('company_size', models.CharField(blank=True, max_length=50, verbose_name='企業規模')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '質問',
                'verbose_name_plural': '質問',
            },
        ),
        migrations.CreateModel(
            name='Answer',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('answer_text', models.TextField(verbose_name='回答内容')),
                ('confidence_score', models.FloatField(default=0.0, verbose_name='信頼度スコア')),
                ('ai_model_used', models.CharField(max_length=50, verbose_name='使用AIモデル')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('question', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, to='advisor.question')),
                ('recommended_subsidies', models.ManyToManyField(blank=True, to='advisor.subsidytype')),
            ],
            options={
                'verbose_name': '回答',
                'verbose_name_plural': '回答',
            },
        ),
        migrations.CreateModel(
            name='AdoptionTips',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('category', models.CharField(choices=[('preparation', '事前準備'), ('application', '申請書作成'), ('documents', '必要書類'), ('strategy', '戦略・ポイント'), ('common_mistakes', 'よくある失敗'), ('success_factors', '成功要因')], max_length=50, verbose_name='カテゴリ')),
                ('title', models.CharField(max_length=200, verbose_name='タイトル')),
                ('content', models.TextField(verbose_name='内容')),
                ('importance', models.IntegerField(choices=[(1, '低'), (2, '中'), (3, '高'), (4, '最重要')], default=2, verbose_name='重要度')),
                ('effective_timing', models.CharField(blank=True, max_length=100, verbose_name='効果的な時期')),
                ('reference_url', models.URLField(blank=True, verbose_name='参考URL')),
                ('is_success_case', models.BooleanField(default=False, verbose_name='成功事例')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('subsidy_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='adoption_tips', to='advisor.subsidytype')),
            ],
            options={
                'verbose_name': '採択ティップス',
                'verbose_name_plural': '採択ティップス',
                'ordering': ['-importance', 'category'],
            },
        ),
        migrations.CreateModel(
            name='UserAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('alert_type', models.CharField(choices=[('preparation_deadline', '準備期限'), ('high_opportunity', '高確率案件'), ('new_subsidy', '新規補助金'), ('trend_change', 'トレンド変化')], max_length=50, verbose_name='アラート種別')),
                ('title', models.CharField(max_length=255, verbose_name='タイトル')),
                ('message', models.TextField(verbose_name='メッセージ')),
                ('priority', models.CharField(choices=[('high', '高'), ('medium', '中'), ('low', '低')], default='medium', max_length=20, verbose_name='優先度')),
                ('action_required', models.TextField(blank=True, null=True, verbose_name='必要なアクション')),
                ('deadline', models.DateField(blank=True, null=True, verbose_name='期限')),
                ('is_read', models.BooleanField(default=False, verbose_name='既読')),
                ('is_dismissed', models.BooleanField(default=False, verbose_name='非表示')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='作成日時')),
                ('read_at', models.DateTimeField(blank=True, null=True, verbose_name='既読日時')),
                ('related_subsidy', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='advisor.subsidytype', verbose_name='関連補助金')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='ユーザー')),
            ],
            options={
                'verbose_name': 'ユーザーアラート',
                'verbose_name_plural': 'ユーザーアラート',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='UserApplicationHistory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('application_date', models.DateField(verbose_name='申請日')),
                ('application_round', models.IntegerField(default=1, verbose_name='申請回次')),
                ('status', models.CharField(choices=[('preparing', '準備中'), ('submitted', '申請済み'), ('under_review', '審査中'), ('adopted', '採択'), ('rejected', '不採択'), ('withdrawn', '取り下げ')], default='preparing', max_length=20, verbose_name='ステータス')),
                ('result_date', models.DateField(blank=True, null=True, verbose_name='結果発表日')),
                ('feedback', models.TextField(blank=True, verbose_name='フィードバック・コメント')),
                ('business_type_at_application', models.CharField(max_length=100, verbose_name='申請時事業種別')),
                ('company_size_at_application', models.CharField(max_length=50, verbose_name='申請時企業規模')),
                ('requested_amount', models.IntegerField(blank=True, null=True, verbose_name='申請金額')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('subsidy_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='advisor.subsidytype')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='application_history', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '申請履歴',
                'verbose_name_plural': '申請履歴',
                'ordering': ['-application_date'],
            },
        ),
        migrations.CreateModel(
            name='SubsidySchedule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('year', models.IntegerField(verbose_name='年度')),
                ('round_number', models.IntegerField(default=1, verbose_name='公募回次')),
                ('application_start_date', models.DateField(verbose_name='申請開始日')),
                ('application_end_date', models.DateField(verbose_name='申請締切日')),
                ('result_announcement_date', models.DateField(blank=True, null=True, verbose_name='結果発表予定日')),
                ('project_start_date', models.DateField(blank=True, null=True, verbose_name='事業開始日')),
                ('project_end_date', models.DateField(blank=True, null=True, verbose_name='事業終了日')),
                ('total_budget', models.BigIntegerField(blank=True, null=True, verbose_name='総予算額')),
                ('allocated_budget', models.BigIntegerField(blank=True, null=True, verbose_name='配分予算額')),
                ('status', models.CharField(choices=[('scheduled', '予定'), ('active', '公募中'), ('closed', '締切済み'), ('completed', '完了'), ('cancelled', '中止')], default='scheduled', max_length=20, verbose_name='ステータス')),
                ('notes', models.TextField(blank=True, verbose_name='備考')),
                ('is_prediction', models.BooleanField(default=False, verbose_name='予測データ')),
                ('confidence_level', models.IntegerField(default=50, help_text='予測の信頼度（0-100%）', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='予測信頼度')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('subsidy_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='schedules', to='advisor.subsidytype')),
            ],
            options={
                'verbose_name': '補助金スケジュール',
                'verbose_name_plural': '補助金スケジュール',
                'ordering': ['year', 'application_start_date', 'round_number'],
                'unique_together': {('subsidy_type', 'year', 'round_number')},
            },
        ),
        migrations.CreateModel(
            name='SubsidyPrediction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('predicted_date', models.DateField(verbose_name='予測公募日')),
                ('confidence_score', models.FloatField(help_text='0.0-1.0の範囲', verbose_name='信頼度スコア')),
                ('estimated_budget', models.IntegerField(blank=True, null=True, verbose_name='予測予算（万円）')),
                ('preparation_deadline', models.DateField(verbose_name='準備期限')),
                ('success_probability', models.FloatField(default=0.25, verbose_name='成功確率')),
                ('recommendation_priority', models.FloatField(default=0.5, verbose_name='推奨優先度')),
                ('prediction_basis', models.JSONField(default=dict, help_text='季節性、過去実績等の分析結果', verbose_name='予測根拠')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='作成日時')),
                ('model_version', models.CharField(default='v1.0', max_length=50, verbose_name='予測モデルバージョン')),
                ('subsidy_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='advisor.subsidytype', verbose_name='補助金種別')),
            ],
            options={
                'verbose_name': '補助金予測',
                'verbose_name_plural': '補助金予測',
                'ordering': ['predicted_date'],
                'unique_together': {('subsidy_type', 'predicted_date')},
            },
        ),
        migrations.CreateModel(
            name='ApplicationScoreCard',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('business_plan_score', models.IntegerField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='事業計画スコア')),
                ('innovation_score', models.IntegerField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='革新性スコア')),
                ('feasibility_score', models.IntegerField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='実現可能性スコア')),
                ('market_potential_score', models.IntegerField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='市場性スコア')),
                ('financial_health_score', models.IntegerField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='財務健全性スコア')),
                ('total_score', models.IntegerField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='総合スコア')),
                ('improvement_suggestions', models.JSONField(default=list, verbose_name='改善提案')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
                ('subsidy_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='advisor.subsidytype')),
            ],
            options={
                'verbose_name': '採択スコアカード',
                'verbose_name_plural': '採択スコアカード',
                'unique_together': {('user', 'subsidy_type')},
            },
        ),
        migrations.CreateModel(
            name='AdoptionStatistics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('year', models.IntegerField(verbose_name='年度')),
                ('round_number', models.IntegerField(default=1, verbose_name='回次')),
                ('total_applications', models.IntegerField(verbose_name='総申請数')),
                ('total_adoptions', models.IntegerField(verbose_name='総採択数')),
                ('adoption_rate', models.FloatField(validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='採択率')),
                ('small_business_applications', models.IntegerField(default=0, verbose_name='小規模事業者申請数')),
                ('small_business_adoptions', models.IntegerField(default=0, verbose_name='小規模事業者採択数')),
                ('medium_business_applications', models.IntegerField(default=0, verbose_name='中小企業申請数')),
                ('medium_business_adoptions', models.IntegerField(default=0, verbose_name='中小企業採択数')),
                ('industry_statistics', models.JSONField(blank=True, default=dict, verbose_name='業種別統計')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('subsidy_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='statistics', to='advisor.subsidytype')),
            ],
            options={
                'verbose_name': '採択統計',
                'verbose_name_plural': '採択統計',
                'ordering': ['-year', '-round_number'],
                'unique_together': {('subsidy_type', 'year', 'round_number')},
            },
        ),
    ]
